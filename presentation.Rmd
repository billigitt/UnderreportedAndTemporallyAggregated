---
title: "Time-dependent Reproduction Numbers: Temporal Aggregation and Under-reporting"
author: "Zak OG"
date: "2024-06-12"
output:
  slidy_presentation: default
  ioslides_presentation: default
  beamer_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

# Reproduction is great!

<p align="center">
    <img src="../../../Downloads/IMG_1628.jpg" alt="Milo" width="400">
</p>

# Why bother with $R_t$?

## Interpretable

$>1$ or $<1$

## Real-time

## Monitor impact of interventions

Suitable retrospectively

# Terminology and Notation

## What we know

- $\boldsymbol{w}$: The discrete generation time distribution, $I_t$: The reported incidence at time $t$

## What we wish we knew

- $X_{t, t-i}$: The number of cases on day $t$ arising due to cases on day $t-i$

## Why?

$$R_t = \frac{\sum_{i=1}X_{t+i,t}}{I_t}$$

## Why don't we know this?

- Transmission trees are hidden
- We can't see into the future!

# Time-dependent reproduction numbers

|Property | $R_t$ (Instantaneous) | $R_t^c$ (Case) |
|----------|:----------:|:----------:|
|Definition| Average number of people someone infected at time $t$ **could expect to infect *should conditions remain unchanged* ** |Average number of people someone infected at time $t$ **can expect to infect**|
|Mean estimate| $\frac{I_t}{\sum_{s=1}I_{t-s}w_s}$   |$\frac{\sum_{s=1} I_{t+s}w_s}{\sum_kI_{t+s-k}w_k}$   |
|Popular Method|Epi-Estim|Wallinga-Teunis|
|Pros|Real-time estimate, Prior information incorporated, Analytical|No inherent condition|
|Cons|Assumes condition remains the same|Simulation-based, Retrospective only, No prior|

# Utility of Reproduction Numbers

- Population Dynamics (birth-counts & maternal age distribution)
- Information Dissemination[^1] (new "believers" & "conversion" distribution)

<p align="right">
    <img src="../churchGrowthModelling.jpg" alt="church" width="300">
</p>

[^1]: https://churchmodel.org.uk/home/about/

# Epi-Estim [^2]

If $R_t \sim \Gamma(a, b)$ and $I_t|I_1^{t-1}, R_t \sim \mathrm{Poi}(R_t\sum_{s=1}I_{t-s}w_s)$, then $$R_t| I_1^t, \boldsymbol{w}\sim \Gamma\left(a+I_t-1, \frac{1}{\sum_{s=1}I_{t-s}w_s+1/b}\right)$$

<p align="center">
    <img src="archive/epiEstimScreenshot.png" alt="GenerationLength" width="400">
</p>

[^2]: Cori A, Ferguson NM, Fraser C, Cauchemez S. A new framework and software to estimate time-varying reproduction numbers during epidemics. Am J Epidemiol. 2013

# Problems outlined in the literature [^3]

1. Generation interval misspecification
2. Adjusting for delays
3. Adjusting for right truncation
4. Accounting for incomplete observation
5. Smoothing windows

[^3]: Gostic KM, McGough L, Baskerville EB, Abbott S, Joshi K, et al. Practical considerations for measuring the effective reproductive number, Rt. PLOS Computational Biology. 2021

# Accounting for incomplete observation

## Temporally aggregated incidence
  + weekly aggregations e.g. Ebola, COVID
  + particularly relevant for short GI (see next slide)
  
## Incidence under-reporting
  + always occurs without mass-testing
  + requires knowledge of reporting probability, $\rho$

# Accounting for incomplete observation (ctd.)

<p align="center">
    <img src="archive/GenerationLength.png" alt="GenerationLength" width="300">
</p>

# Method accounting for temporally aggregated incidence: Exact ABC [^4]

<p align="center">
    <img src="archive/schematic1.png" alt="GenerationLength" width="600">
</p>

[^4]: *Ogi-Gittins et al. A simulation-based approach for estimating the time-dependent reproduction number from temporally aggregated disease incidence time series data,  2024

# Results 1

<p align="center">
    <img src="archive/syntheticScreenshot1.png" alt="GenerationLength" width="400">
</p>

# Results 2

<p align="center">
    <img src="archive/originalMethodRWD.png" alt="My Image" width="400">
</p>

# Method accounting for temporally aggregated incidence and under-reporting: Weighting with Binomial likelihoods

<p align="center">
    <img src="figs/processing/schematicPostOxford.svg" alt="My Image" width="600">
</p>

# Results

<p align="center">
    <img src="figs/sectionOldVsNew/MicrosoftTeams-image.png" alt="My Image" width="500" >
</p>


# Results

<p align="center">
    <img src="figs/archive/largeScaleStudy.svg" alt="My Image" width="1000">
</p>

# Results

<p align="center">
    <img src="figs/sectionEffectOfRho/increasingRhoIsGood.svg" alt="My Image" width="1000">
</p>

# Conclusions

- $R_t$ inference not accounting for temporally aggregated incidence can lead to large errors in $R_t$ inference
- $R_t$ inference accounting for temporally aggregated incidence but not under-reporting can lead to incorrect coverage
- We can solve both problems with these simulation-based approaches, and the latter approach can improve speed!

# Thank you!

Questions?



